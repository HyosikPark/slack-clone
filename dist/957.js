(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[957],{3732:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var o=n(7294),a=n(5366);const s=(0,a.Z)("div",{target:"e11ronk61"})({name:"1py64fr",styles:"position:fixed;text-align:center;top:50%;left:50%;transform:translate(-25%, -50%);width:440px;background:white;--saf-0:rgba(var(--sk_foreground_low, 29, 28, 29), 0.13);box-shadow:0 0 0 1px var(--saf-0),0 4px 12px 0 rgba(0, 0, 0, 0.12);background-color:rgba(var(--sk_foreground_min_solid, 248, 248, 248), 1);border-radius:6px;user-select:none;max-width:440px;padding:30px 40px 0;z-index:1012"});(0,a.Z)("button",{target:"e11ronk60"})({name:"19gmbxq",styles:"position:absolute;right:10px;top:6px;background:transparent;border:none;font-size:30px;cursor:pointer"});var r=n(917);function i({children:e,show:t}){const n=(0,o.useCallback)((e=>{e.stopPropagation()}),[]);return t?(0,r.tZ)(s,{"data-testid":"modal",onClick:n},e):null}const l=o.memo(i)},2951:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var o=n(7294),a=n(6809),s=n.n(a);const r={};function i(e){r[e]||(r[e]=s().connect(`http://localhost:3095/ws-${e}`,{transports:["websocket"]}));const t=(0,o.useCallback)((()=>{e&&!r[e]||(r[e].disconnect(),delete r[e])}),[e]);return e?[r[e],t]:[void 0,t]}},2224:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>K});var o=n(7294),a=n(5977),s=n(3564),r=n(9669),i=n.n(r),l=n(8100),c=n(5366);const p=(0,c.Z)("div",{target:"evhqx3h13"})({name:"tjo4qw",styles:"float:right"}),d=(0,c.Z)("header",{target:"evhqx3h12"})({name:"fvf0bi",styles:"height:38px;background:#350d36;color:#ffffff;box-shadow:0 1px 0 0 rgba(255, 255, 255, 0.1);padding:5px;text-align:center"}),u=(0,c.Z)("img",{target:"evhqx3h11"})({name:"jh3bjl",styles:"width:28px;height:28px;position:absolute;top:5px;right:16px;cursor:pointer"}),h=(0,c.Z)("div",{target:"evhqx3h10"})({name:"47px7v",styles:"display:flex;padding:20px;& img{display:flex;}&>div{display:flex;flex-direction:column;margin-left:10px;}& #profile-name{font-weight:bold;display:inline-flex;}& #profile-active{font-size:13px;display:inline-flex;}"}),m=(0,c.Z)("button",{target:"evhqx3h9"})({name:"bl1q1k",styles:"border:none;width:100%;border-top:1px solid rgb(29, 28, 29);background:transparent;display:block;height:33px;padding:5px 20px 5px;outline:none;cursor:pointer"}),g=(0,c.Z)("div",{target:"evhqx3h8"})({name:"36bnqj",styles:"display:flex;flex:1"}),b=(0,c.Z)("div",{target:"evhqx3h7"})({name:"17lvj7e",styles:"width:65px;display:inline-flex;flex-direction:column;align-items:center;background:#3f0e40;border-top:1px solid rgb(82, 38, 83);border-right:1px solid rgb(82, 38, 83);vertical-align:top;text-align:center;padding:15px 0 0"}),x=(0,c.Z)("nav",{target:"evhqx3h6"})({name:"2pkygn",styles:"width:260px;display:inline-flex;flex-direction:column;background:#3f0e40;color:rgb(188, 171, 188);vertical-align:top;& a{padding-left:36px;color:inherit;text-decoration:none;height:28px;line-height:28px;display:flex;align-items:center;&.selected{color:white;}}& .bold{color:white;font-weight:bold;}& .count{margin-left:auto;background:#cd2553;border-radius:16px;display:inline-block;font-size:12px;font-weight:700;height:18px;line-height:18px;padding:0 9px;color:white;margin-right:16px;}& h2{height:36px;line-height:36px;margin:0;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;font-size:15px;}"}),f=(0,c.Z)("button",{target:"evhqx3h5"})({name:"1rmthq7",styles:"height:64px;line-height:64px;border:none;width:100%;text-align:left;border-top:1px solid rgb(82, 38, 83);border-bottom:1px solid rgb(82, 38, 83);font-weight:900;font-size:24px;background:transparent;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;padding:0;padding-left:16px;margin:0;color:white;cursor:pointer"}),Z=(0,c.Z)("div",{target:"evhqx3h4"})({name:"1146j5j",styles:"height:calc(100vh - 102px);overflow-y:auto"}),k=(0,c.Z)("div",{target:"evhqx3h3"})({name:"192o1ir",styles:"padding:10px 0 0;& h2{padding-left:20px;}&>button{width:100%;height:28px;padding:4px;border:none;background:transparent;border-top:1px solid rgb(28, 29, 28);cursor:pointer;&:last-of-type{border-bottom:1px solid rgb(28, 29, 28);}}"}),w=(0,c.Z)("div",{target:"evhqx3h2"})({name:"82a6rk",styles:"flex:1"}),v=(0,c.Z)("button",{target:"evhqx3h1"})({name:"9tlmej",styles:"color:white;font-size:24px;display:inline-block;width:40px;height:40px;background:transparent;border:none;cursor:pointer"}),_=(0,c.Z)("button",{target:"evhqx3h0"})({name:"wsqixl",styles:"display:inline-block;width:40px;height:40px;border-radius:10px;background:white;border:3px solid #3f0e40;margin-bottom:15px;font-size:18px;font-weight:700;color:black;cursor:pointer"});var y=n(6182),C=n.n(y),q=n(1684);const $=(0,c.Z)("div",{target:"e1nvy8cl1"})({name:"1gtedvk",styles:"z-index:1000;position:absolute;--saf-0:rgba(var(--sk_foreground_low, 29, 28, 29), 0.13);box-shadow:0 0 0 1px var(--saf-0),0 4px 12px 0 rgba(0, 0, 0, 0.12);background-color:rgba(var(--sk_foreground_min_solid, 248, 248, 248), 1);border-radius:6px;user-select:none;min-width:360px;z-index:512;max-height:calc(100vh - 20px);color:rgb(29, 28, 29)"});(0,c.Z)("button",{target:"e1nvy8cl0"})({name:"19gmbxq",styles:"position:absolute;right:10px;top:6px;background:transparent;border:none;font-size:30px;cursor:pointer"});var S=n(917);function I({children:e,style:t,show:n}){const a=(0,o.useCallback)((e=>{e.stopPropagation()}),[]);return n?(0,S.tZ)($,{"data-testid":"menu",style:t,onClick:a},e):null}I.defaultProps={closeButton:!0};const z=o.memo(I);var P=n(3727),N=n(3732),j=n(3046),M=n(9249);function O({show:e,onCloseModal:t}){const n=(0,o.useRef)(null),{workspace:s}=(0,a.UO)(),r=(0,o.useCallback)((e=>{e.preventDefault(),n.current?.value.trim()&&i().post(`/api/workspaces/${s}/channels`,{name:n.current?.value},{withCredentials:!0}).then((()=>{(0,l.X$)(`/api/workspaces/${s}/channels`),t()})).catch((e=>{console.dir(e),M.Am.error(e.response?.data,{position:"bottom-center"})}))}),[t,s]);return(0,S.tZ)(N.Z,{show:e},(0,S.tZ)("form",{onSubmit:r},(0,S.tZ)(j.__,{id:"workspace-label"},(0,S.tZ)("span",null,"워크스페이스 이름"),(0,S.tZ)(j.II,{id:"workspace",ref:n})),(0,S.tZ)(j.zx,{type:"submit"},"생성하기")))}const U=o.memo(O);function A({show:e,onCloseModal:t}){const n=(0,o.useRef)(null),a=(0,o.useRef)(null),s=(0,o.useCallback)((e=>{e.preventDefault(),n.current?.value.trim()&&a.current?.value.trim()&&i().post("/api/workspaces",{workspace:n.current?.value,url:a.current?.value},{withCredentials:!0}).then((()=>{(0,l.X$)("/api/users"),t()})).catch((e=>{M.Am.error(e.response?.data,{position:"bottom-center"})}))}),[t]);return(0,S.tZ)(N.Z,{show:e},(0,S.tZ)("form",{onSubmit:s},(0,S.tZ)(j.__,{id:"workspace-label"},(0,S.tZ)("span",null,"워크스페이스 이름"),(0,S.tZ)(j.II,{id:"workspace",ref:n})),(0,S.tZ)(j.__,{id:"workspace-url-label"},(0,S.tZ)("span",null,"워크스페이스 url"),(0,S.tZ)(j.II,{id:"workspace",ref:a})),(0,S.tZ)(j.zx,{type:"submit"},"생성하기")))}const L=o.memo(A);function E({show:e,onCloseModal:t}){const{workspace:n}=(0,a.UO)(),s=(0,o.useRef)(null),r=(0,o.useCallback)((e=>{e.preventDefault(),s.current?.value.trim()&&i().post(`/api/workspaces/${n}/members`,{email:s.current.value},{withCredentials:!0}).then((()=>{(0,l.X$)(`/api/workspaces/${n}/members`),t()})).catch((e=>{M.Am.error(e.response?.data,{position:"bottom-center"})}))}),[t,n]);return(0,S.tZ)(N.Z,{show:e},(0,S.tZ)("form",{onSubmit:r},(0,S.tZ)(j.__,{id:"member-label"},(0,S.tZ)("span",null,"이메일"),(0,S.tZ)(j.II,{id:"member",type:"email",ref:s})),(0,S.tZ)(j.zx,{type:"submit"},"초대하기")))}const D=o.memo(E);var R=n(2951);const W=(0,c.Z)("button",{target:"e10l0bpo0"})("background:transparent;border:none;width:26px;height:26px;display:inline-flex;justify-content:center;align-items:center;color:white;margin-left:10px;cursor:pointer;",(({collapse:e})=>e&&"\n    & i {\n      transform: none;\n    }\n  "),";");function X(){const{workspace:e}=(0,a.UO)(),t=(0,a.TH)(),{data:n}=(0,l.ZP)("/api/users",s._),{data:r}=(0,l.ZP)(n?`/api/workspaces/${e}/channels`:null,s._),[i]=(0,R.Z)(e),[c,p]=(0,o.useState)(!1),[d,u]=(0,o.useState)({}),h=(0,o.useCallback)((()=>{p((e=>!e))}),[]),m=(0,o.useCallback)((e=>()=>{u((t=>({...t,[e]:void 0})))}),[]);(0,o.useEffect)((()=>{u({})}),[e,t]);const g=(0,o.useCallback)((e=>{if(e.content.match(/@\[(.+?)]\((\d)\)/g)?.find((e=>e.match(/@\[(.+?)]\((\d)\)/)[2]===n?.id.toString())))return u((t=>({...t,[`c-${e.ChannelId}`]:(t[`c-${e.ChannelId}`]||0)+1})));u((t=>({...t,[`c-${e.ChannelId}`]:t[`c-${e.ChannelId}`]||0})))}),[n?.id]);return(0,o.useEffect)((()=>(i?.on("message",g),console.log("socket on message",i?.hasListeners("message")),()=>{i?.off("message",g),console.log("socket off message",i?.hasListeners("message"))})),[g,i]),(0,S.tZ)(o.Fragment,null,(0,S.tZ)("h2",{style:{cursor:"pointer"},onClick:h},(0,S.tZ)(W,{collapse:c},(0,S.tZ)("i",{className:"c-icon p-channel_sidebar__section_heading_expand p-channel_sidebar__section_heading_expand--show_more_feature c-icon--caret-right c-icon--inherit c-icon--inline","data-qa":"channel-section-collapse","aria-hidden":"true"})),(0,S.tZ)("span",null,"Channels")),(0,S.tZ)("div",null,!c&&r?.map?.((t=>{const n=d[`c-${t.id}`];return(0,S.tZ)(P.OL,{key:t.name,activeClassName:"selected",to:`/workspace/${e}/channel/${t.name}`,onClick:m(`c-${t.id}`)},(0,S.tZ)("span",{className:void 0!==n&&n>=0?"bold":void 0},"# ",t.name),void 0!==n&&n>0&&(0,S.tZ)("span",{className:"count"},n))}))))}const F=o.memo(X);function B(){const{workspace:e}=(0,a.UO)(),[t]=(0,R.Z)(e),{data:n}=(0,l.ZP)("/api/users",s._),{data:r}=(0,l.ZP)(n?`/api/workspaces/${e}/members`:null,s._),[i,c]=(0,o.useState)(!1),[p,d]=(0,o.useState)({}),[u,h]=(0,o.useState)([]),m=(0,o.useCallback)((()=>{c((e=>!e))}),[]),g=(0,o.useCallback)((e=>()=>{d((t=>({...t,[e]:0})))}),[]),b=e=>{d((t=>({...t,[e.SenderId]:t[e.SenderId]?t[e.SenderId]+1:1})))};return(0,o.useEffect)((()=>(t?.on("onlineList",(e=>{h(e)})),t?.on("dm",b),()=>{t?.off("dm",b),t?.off("onlineList")})),[t]),(0,S.tZ)(o.Fragment,null,(0,S.tZ)("h2",{style:{cursor:"pointer"},onClick:m},(0,S.tZ)(W,{collapse:i},(0,S.tZ)("i",{className:"c-icon p-channel_sidebar__section_heading_expand p-channel_sidebar__section_heading_expand--show_more_feature c-icon--caret-right c-icon--inherit c-icon--inline","data-qa":"channel-section-collapse","aria-hidden":"true"})),(0,S.tZ)("span",null,"Direct Messages")),(0,S.tZ)("div",null,!i&&r?.map?.((t=>{const o=u.includes(t.id),a=p[t.id]||0;return(0,S.tZ)(P.OL,{key:t.id,activeClassName:"selected",to:`/workspace/${e}/dm/${t.id}`,onClick:g(t.id)},(0,S.tZ)("i",{className:"c-icon p-channel_sidebar__presence_icon p-channel_sidebar__presence_icon--dim_enabled c-presence "+(o?"c-presence--active c-icon--presence-online":"c-icon--presence-offline"),"aria-hidden":"true","data-qa":"presence_indicator","data-qa-presence-self":"false","data-qa-presence-active":"false","data-qa-presence-dnd":"false"}),(0,S.tZ)("span",{className:a>0?"bold":void 0},t.nickname),t.id===n?.id&&(0,S.tZ)("span",null," (나)"),a>0&&(0,S.tZ)("span",{className:"count"},a))}))))}const H=o.memo(B),T=(0,q.ZP)((()=>Promise.all([n.e(686),n.e(216),n.e(818)]).then(n.bind(n,5818)))),G=(0,q.ZP)((()=>Promise.all([n.e(686),n.e(216),n.e(438)]).then(n.bind(n,4438))));function J(){const{workspace:e}=(0,a.UO)(),{data:t,mutate:n}=(0,l.ZP)("/api/users",s._),{data:r}=(0,l.ZP)(t?`/api/workspaces/${e}/channels`:null,s._),[c,y]=(0,o.useState)(!1),[q,$]=(0,o.useState)(!1),[I,N]=(0,o.useState)(!1),[j,M]=(0,o.useState)(!1),[O,A]=(0,o.useState)(!1),[E,W]=(0,o.useState)(!1),[X,B]=(0,R.Z)(e);(0,o.useEffect)((()=>{r&&t&&X&&X.emit("login",{id:t.id,channels:r.map((e=>e.id))})}),[r,X,t]),(0,o.useEffect)((()=>()=>{B()}),[B]);const J=(0,o.useCallback)((()=>{i().post("/api/users/logout",null,{withCredentials:!0}).then((()=>n(!1,!1)))}),[n]),K=(0,o.useCallback)((e=>{const t=e.target.id;return"open-ic-btn"===t?W(!0):"open-iws-btn"===t?A(!0):"user-profile"===t?y(!0):"open-ws-btn"===t?M(!0):"open-cws-btn"===t?$(!0):"open-cc-btn"===t?N(!0):void 0}),[]),Q=(0,o.useCallback)((()=>E?W(!1):O?A(!1):q?$(!1):I?N(!1):c?y(!1):j?M(!1):void 0),[E,O,q,I,c,j]);return void 0===t?null:!1===t?(0,S.tZ)(a.l_,{to:"/login"}):(0,S.tZ)("div",{"data-testid":"workspace-container",className:"workspace-container",onClick:Q},(0,S.tZ)(d,null,(0,S.tZ)(p,null,(0,S.tZ)(u,{id:"user-profile","data-testid":"user-profile",onClick:K,src:C().url(t.nickname,{s:"20px",d:"retro"}),alt:t.nickname}),(0,S.tZ)(z,{style:{right:0,top:38},show:c},(0,S.tZ)(h,null,(0,S.tZ)("img",{src:C().url(t.nickname,{s:"20px",d:"retro"}),alt:t.nickname}),(0,S.tZ)("div",null,(0,S.tZ)("span",{id:"profile-name"},t.nickname),(0,S.tZ)("span",{id:"profile-active"},"Active"))),(0,S.tZ)(m,{onClick:J},"로그아웃")))),(0,S.tZ)(g,null,(0,S.tZ)(b,null,t?.Workspaces?.map((e=>(0,S.tZ)(P.rU,{key:e.id,to:`/workspace/${e.url}/channel/일반`},(0,S.tZ)(_,null,e.name.slice(0,1).toUpperCase())))),(0,S.tZ)(v,{id:"open-cws-btn",onClick:K},"+")),(0,S.tZ)(x,null,(0,S.tZ)(f,{id:"open-ws-btn",onClick:K},"Sleact"),(0,S.tZ)(Z,null,(0,S.tZ)(z,{show:j,style:{top:95,left:80}},(0,S.tZ)(k,null,(0,S.tZ)("h2",null,"Sleact"),(0,S.tZ)("button",{id:"open-iws-btn",onClick:K},"워크스페이스에 사용자 초대"),(0,S.tZ)("button",{id:"open-cc-btn",onClick:K},"채널 만들기"),(0,S.tZ)("button",{onClick:J},"로그아웃"))),(0,S.tZ)(F,null),(0,S.tZ)(H,null))),(0,S.tZ)(w,null,(0,S.tZ)(a.rs,null,(0,S.tZ)(a.AW,{path:"/workspace/:workspace/channel/:channel",render:()=>(0,S.tZ)(T,{show:E,onCloseModal:Q,onOpenModal:K})}),(0,S.tZ)(a.AW,{path:"/workspace/:workspace/dm/:id",component:G})))),(0,S.tZ)(L,{show:q,onCloseModal:Q}),(0,S.tZ)(U,{show:I,onCloseModal:Q}),(0,S.tZ)(D,{show:O,onCloseModal:Q}))}const K=o.memo(J)},3564:(e,t,n)=>{"use strict";n.d(t,{_:()=>s});var o=n(9669),a=n.n(o);function s(e){return a().get(e,{withCredentials:!0}).then((e=>e.data))}},418:()=>{}}]);